!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){var n,a,o,d,c;!(o=function(e){var t=(i(!function(){var e=new Error('Cannot find module "mdater"');throw e.code="MODULE_NOT_FOUND",e}()),i(!function(){var e=new Error('Cannot find module "exif"');throw e.code="MODULE_NOT_FOUND",e}())),n=i(!function(){var e=new Error('Cannot find module "canvasFuns"');throw e.code="MODULE_NOT_FOUND",e}()),a={imgsData:new Array,savimg_maxwidth:750,$add01:$("#addPic-01"),$add02:$("#addPic-02"),count:0,_bindEvent:function(){$("#f-pic").live("change",this.uploadPic),this.$add01.on("click",function(){$("#f-pic").click()}),this.$add02.on("click",function(){$("#f-pic").click()}),$(".uploaded-pics").delegate(".delete-area","click",this.deletePic),$("#end").mdater({minDate:new Date}),$("#post").on("click",this.finish),$("#toPost").on("click",this.backToPost)},finish:function(){if("\u53d1\u5e03"==$(this).text()){var e=!1,t=!1,i=!1,n=!1,o=!1;a.checkPic()&&(e=!0),a.checkTitle()&&(t=!0),a.checkReason()&&(i=!0),a.checkTime()&&(n=!0),a.checkAddress()&&(o=!0),$("#complete-info").removeClass("page-on-right"),$("#post-wrapper").addClass("page-to-left"),setTimeout(function(){$("#post-wrapper").removeClass("page-to-left").addClass("page-on-left")},300),$(this).text("\u53d1\u5e03\u4e2d"),$("#post").unbind("click");for(var d="",c=0;c<a.imgsData.length;c++)d=d+'<input type="hidden" name="image_data'+c+'" id="image_data'+c+'" value="'+a.imgsData[c]+'" />';$("#div-imgdata").html(d),$(this).text("\u53d1\u5e03"),$("#post").on("click",a.finish)}},backToPost:function(){$("#complete-info").addClass("page-on-right"),$("#post-wrapper").removeClass("page-on-left")},showTip:function(e){var t='<div class="popup-tip">'+e+"</div>";$("body").append(t),setTimeout(function(){$(".popup-tip").remove()},1e3)},checkPic:function(){return 0==$(".uploaded-pics ul li").length?($("#pic-tip").text("*\u8bf7\u4e0a\u4f20\u56fe\u7247"),!1):($("#pic-tip").text(""),!0)},checkTitle:function(){var e=$("#title").val();return""==e||0==e.length?($("#title-tip").text("*\u8bf7\u586b\u5199\u6807\u9898"),!1):($("#title-tip").text(""),!0)},checkReason:function(){var e=$("#reason").val();return""==e||0==e.length?($("#reason-tip").text("*\u8bf7\u586b\u5199\u63a8\u8350\u7406\u7531"),!1):($("#reason-tip").text(""),!0)},checkTime:function(){var e=$("#end").val();return""==e||0==e.length?($("#time-tip").text("*\u8bf7\u8f93\u5165\u622a\u6b62\u65f6\u95f4"),!1):($("#time-tip").text(""),!0)},checkAddress:function(){var e=$("#address").text();return""==e||0==e.length?($("#address-tip").text("*\u8bf7\u586b\u5199\u5730\u5740"),!1):($("#address-tip").text(""),!0)},uploadPic:function(){if(this.count++,$("#f-pic").replaceWith('<input type="file" id="f-pic" capture="camera" accept="image/jpg,image/jpeg,image/png,image/gif" style="visibility:hidden;" title="'+this.count+'">'),$(".uploaded-pics ul li").length>=9)return a.showTip("\u6700\u591a\u53ea\u80fd\u4e0a\u4f209\u5f20\u56fe\u7247\uff01"),!1;a.$add01.parent(".camera-add").hasClass("hide")||(a.$add01.parent(".camera-add").addClass("hide"),a.$add02.removeClass("hide"));var e='<li><div class="delete-area hide"><i class="delete-icon"></i></div><div class="load-pic"></div><p class="hide">\u8bf7\u91cd\u65b0\u4e0a\u4f20</p></li>';$(e).appendTo($(".uploaded-pics ul")),$(".uploaded-pics ul li").length>=9&&!a.$add02.hasClass("hide")&&a.$add02.addClass("hide");var i="",o=this.files[0],d=null;t.getData(o,function(){t.getAllTags(this),d=t.getTag(this,"Orientation")}),i=a.getObjectURL(o);var c=$(".uploaded-pics ul li:last-child"),s=new Image;s.onload=function(){var e=this.width,t=this.height,i=0,o=0;e<=a.savimg_maxwidth?(i=e,o=t):(i=a.savimg_maxwidth,o=t*i/e);for(var s=n.getImgToCanvasData(this,i,o,d),r=0;r<a.imgsData.length;r++)if(a.imgsData[r]==s)return c.remove(),a.showTip("\u8bf7\u52ff\u91cd\u590d\u4e0a\u4f20\u56fe\u7247"),!1;a.imgsData[a.imgsData.length]=s,c.children(".load-pic").addClass("hide"),c.children(".delete-area").removeClass("hide"),c.css({background:"url("+s+")","background-size":"cover","background-position":"center"})},s.onerror=function(){a.imgsData[a.imgsData.length]=null,c.children(".load-pic").addClass("hide"),c.children("p.hide").removeClass("hide"),c.children(".delete-area").removeClass("hide")},s.src=i},deletePic:function(){var e=$(this).parent(".uploaded-pics ul li").index();$(".uploaded-pics ul li").eq(e).remove(),a.imgsData.splice(e,1),$(".uploaded-pics ul li").length<=9&&a.$add02.hasClass("hide")&&a.$add02.removeClass("hide"),0==$(".uploaded-pics ul li").length&&(a.$add01.parent(".camera-add").removeClass("hide"),a.$add02.addClass("hide"))},start_date:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate(),a=t+"-"+i+"-"+n;$("#start").text(a)},getObjectURL:function(e){var t=null;return void 0!=window.createObjectURL?t=window.createObjectURL(e):void 0!=window.URL?t=window.URL.createObjectURL(e):void 0!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},init:function(){this.start_date(),this._bindEvent()}};return a}.call(t,i,t,e)),n=[!function(){var e=new Error('Cannot find module "http://webapi.amap.com/maps?v=1.3&key=ce3b5cdd3320877043e663bd19e9e0e8&plugin=AMap.Geocoder"');throw e.code="MODULE_NOT_FOUND",e}()],!(a=function(){var e={map_init:function(){$("#address-tip").text("\uff0a\u6b63\u5728\u83b7\u53d6\u4f60\u7684\u5f53\u524d\u4f4d\u7f6e...");var t,i;t=new AMap.Map(""),t.plugin("AMap.Geolocation",function(){i=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4}),t.addControl(i),i.getCurrentPosition(),AMap.event.addListener(i,"complete",e.onComplete),AMap.event.addListener(i,"error",e.onError)})},onComplete:function(t){$("#address-tip").text("");var i=[t.position.getLng(),t.position.getLat()];new e.regeocoder(i)},regeocoder:function(t){var i=new AMap.Geocoder({radius:1e3,extensions:"all"});i.getAddress(t,function(t,i){"complete"===t&&"OK"===i.info&&e.geocoder_CallBack(i)})},geocoder_CallBack:function(e){var t=e.regeocode.formattedAddress;$("#address").text(t)},onError:function(){$("#address-tip").text("\uff0a\u81ea\u52a8\u83b7\u53d6\u4f4d\u7f6e\u5931\u8d25")},init:function(){$(".get-address").on("click",this.map_init)}};return e}.apply(t,n)),!(d=function(){var e={$tip:$(".login-tip"),countdown:60,checkMobile:function(){var e=/^(1(([3578][0-9])|(47)))\d{8}$/,t=$("#mobile").val();return""==t||0==t.length?(this.$tip.text("\u8bf7\u8f93\u5165\u624b\u673a\u53f7").css("visibility","visible"),!1):e.test(t)===!1?(this.$tip.text("\u624b\u673a\u53f7\u7801\u683c\u5f0f\u9519\u8bef").css("visibility","visible"),!1):(this.$tip.css("visibility","hidden"),!0)},checkVericode:function(){var e=$("#vericode").val();return""==e||0==e.length?(this.$tip.text("\u8bf7\u8f93\u5165\u624b\u673a\u77ed\u4fe1\u9a8c\u8bc1\u7801").css("visibility","visible"),!1):(this.$tip.css("visibility","hidden"),!1)},checkPassword:function(){var e=$("#password").val(),t=/^[0-9a-zA-Z!@#$%^&*]{6,16}$/;return""==e||0==e.length?(this.$tip.text("\u8bf7\u8f93\u5165\u5bc6\u7801").css("visibility","visible"),!1):t.test(e)===!1?(this.$tip.text("\u5bc6\u7801\u683c\u5f0f\u9519\u8bef").css("visibility","visible"),!1):(this.$tip.css("visibility","hidden"),!0)},timer:function(t){return 0==this.countdown?(t.text("\u83b7\u53d6"),void(this.countdown=60)):(t.text("\u91cd\u65b0\u83b7\u53d6("+this.countdown+"s)"),this.countdown--,void setTimeout(function(){e.timer(t)},1e3))},tip:function(e){if(0==$(".popup-tip").length){var t='<div class="popup-tip">'+e+'</div><div class="overlay"></div>';$("body").append(t),setTimeout(function(){$(".overlay, .popup-tip").remove()},600)}},init:function(){$(".get-code").click(function(){e.checkMobile&&e.countdown&&(e.timer($(this)),e.tip("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u5230\u60a8\u624b\u673a"))}),$("#finish").click(function(){e.checkMobile&&e.checkVericode&&alert("12344")})}};return e}.call(t,i,t,e)),c=function(e){i(!function(){var e=new Error('Cannot find module "zepto"');throw e.code="MODULE_NOT_FOUND",e}());p=o,g=a,l=d,p.init(),g.init(),l.init()}.call(t,i,t,e),!(void 0!==c&&(e.exports=c))}]);