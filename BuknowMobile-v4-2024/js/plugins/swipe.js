var swipe=function(n,t){"use strict";function e(n){var t=v.children.length;for(n%=t;t--;)v.children[t].className=t===n?"active":""}function i(){$=(d=n.children).length,t.continuous&&3>$&&(n.appendChild(d[0].cloneNode(!0)),n.appendChild(n.children[1].cloneNode(!0)),$=(d=n.children).length,b=!0),_=Array($),h=n.getBoundingClientRect().width||n.offsetWidth;for(var e=$;e--;)d[e].setAttribute("data-index",e),s(e,x>e?-h:e>x?h:0,0);t.continuous&&(0===x&&s(a(x-1),-h,0),x===$&&s(a(x+1),h,0)),n.style.visibility="visible"}function o(){t.continuous?r(x+1):x<d.length-1&&r(x+1)}function a(n){return(d.length+n%d.length)%d.length}function r(n,i){if(x!=n){var o=Math.abs(x-n)/(x-n);if(t.continuous){var r=o;(o=-_[a(n)]/h)!==r&&(n=-o*d.length+n)}for(var c=Math.abs(x-n)-1;c--;)s(a((n>x?n:x)-c-1),h*o,0);n=a(n),s(x,h*o,i||p),s(n,0,i||p),t.continuous&&s(a(n-o),-(h*o),0),e(x=n),f(t.callback&&t.callback(x,d[x]))}}function s(n,t,e){c(n,t,e),_[n]=t}function c(n,t,e){var i=d[n],o=i&&i.style;o&&(o.webkitTransitionDuration=o.transitionDuration=e+"ms",o.webkitTransform="translate("+t+"px,0)translateZ(0)",o.transform="translateX("+t+"px)")}function u(){m=0,clearTimeout(g)}if(t=t||{},n&&n.nodeType&&0!==n.children.length){var l={touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(n){var t=["transitionProperty","WebkitTransition"];for(var e in t)if(void 0!==n.style[t[e]])return!0;return!1}(document.createElement("swipe"))};if(!l.touch||!l.transitions||1===n.children.length)return void(n.style.visibility="visible");var d,_,h,$,v,f=function(n){setTimeout(n,0)},b=!1,x=parseInt(t.startSlide,10)||0,p=t.speed||300;t.continuous=void 0===t.continuous||t.continuous,function(){if(t.pointers){var e=n.children.length,i=e;for(v=t.pointers;i--;){var o=document.createElement("i");e-i-1===x&&(o.className="active"),v.appendChild(o)}}}();var g,m=t.auto||0;i(),m&&(g=setTimeout(o,m));var E,k,y={},w={};return k={handleEvent:function(n){switch(n.type){case"touchstart":this.start(n);break;case"touchmove":this.move(n);break;case"touchend":f(this.end(n));break;case"resize":f(i.call());break;case"webkitTransitionEnd":case"transitionend":f(this.transitionEnd(event))}},start:function(t){var e=t.touches[0];y={x:e.pageX,y:e.pageY,time:+new Date},E=void 0,w={},n.addEventListener("touchmove",this,!1),n.addEventListener("touchend",this,!1)},move:function(n){if(!(n.touches.length>1||n.scale&&1!==n.scale)){var e=n.touches[0];w={x:e.pageX-y.x,y:e.pageY-y.y},void 0===E&&(E=!!(E||Math.abs(w.x)<Math.abs(w.y))),E||(n.preventDefault(),u(),t.continuous?(c(a(x-1),w.x+_[a(x-1)],0),c(x,w.x+_[x],0),c(a(x+1),w.x+_[a(x+1)],0)):(w.x=w.x/(!x&&w.x>0||x==d.length-1&&w.x<0?Math.abs(w.x)/h+1:1),c(x-1,w.x+_[x-1],0),c(x,w.x+_[x],0),c(x+1,w.x+_[x+1],0)))}},end:function(){var i=250>Number(+new Date-y.time)&&Math.abs(w.x)>20||Math.abs(w.x)>h/2,o=!x&&w.x>0||x==d.length-1&&w.x<0;t.continuous&&(o=!1);var r=w.x<0;E||(i&&!o?(r?(t.continuous?(s(a(x-1),-h,0),s(a(x+2),h,0)):s(x-1,-h,0),s(x,_[x]-h,p),s(a(x+1),_[a(x+1)]-h,p),x=a(x+1)):(t.continuous?(s(a(x+1),h,0),s(a(x-2),-h,0)):s(x+1,h,0),s(x,_[x]+h,p),s(a(x-1),_[a(x-1)]+h,p),x=a(x-1)),e(x),t.callback&&t.callback(x,d[x])):t.continuous?(s(a(x-1),-h,p),s(x,0,p),s(a(x+1),h,p)):(s(x-1,-h,p),s(x,0,p),s(x+1,h,p))),n.removeEventListener("touchmove",k,!1),n.removeEventListener("touchend",k,!1)},transitionEnd:function(n){parseInt(n.target.getAttribute("data-index"),10)==x&&(t.auto&&(clearTimeout(g),g=setTimeout(o,t.auto)),t.transitionEnd&&t.transitionEnd.call(event,x,d[x]))}},n.addEventListener("touchstart",k,!1),window.addEventListener("resize",k,!1),n.addEventListener("webkitTransitionEnd",k,!1),n.addEventListener("transitionend",k,!1),{next:function(){u(),o()},prev:function(){u(),t.continuous?r(x-1):x&&r(x-1)},slide:function(n,t){u(),r(n,t)},pos:function(){return x},len:function(){return b?2:d.length}}}};export default swipe;