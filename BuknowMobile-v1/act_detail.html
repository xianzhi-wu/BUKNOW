<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection" content="telephone=no" />
<meta name="format-detection" content="email=no" />
<meta name="apple-mobile-web-app-title" content="">
<meta name="Keywords" content=""/>
<meta name="Description" content=""/>
<title>buknow</title>
<link rel="stylesheet" type="text/css" href="css/common.css"/>
</head>
<body style="overflow:hidden;" onload="loaded()">
<header class="header box_layout">
  <a href="javascript:history.go(-1);" class="back mr44"></a>
  <div class="header_text box_col">活动详情</div>
  <a class="search header_icon"></a>
  <a class="menu header_icon"></a>
</header>

<article class="act_wrapper">
  <section class="content">
    <header class="act_top">
      <img id="img" src="images/media_pcs/banner01.jpg">
      <div class="act_info">
        <span class="pic_name">亚马逊</span>
        <span class="pic_amount">15张</span>
        <span class="act_date">发布日期：2015/01/12</span>
      </div>
    </header>
    <section class="act_bottom">
      <div class="act_tit">Calvin Klein Agile K2Z2S61W 镶钻 女款时装腕表</div>
      <div class="act_price">$128(需用码,￥840)</div>
      <div class="collect_share">
        <a href="#"><span class="buy_icon"></span>去亚马逊</a>
        <a><span class="collect_icon"></span>收藏(1)</a>
        <a><span class="share"></span>分享</a>
      </div>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein腕表就应有了类似的
      理念，这款CK女士腕表型号为K2Z2S61W，号称世界最轻的腕表。双指针以及CK的LOGO装饰表盘。防刮擦矿物水晶表镜，而且这款和银色款不同，内置的是瑞士石英机芯；表径37mm，厚7mm，防水30m。</p>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein</p>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein</p>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein腕表就应有了类似的
      理念，这款CK女士腕表型号为K2Z2S61W，号称世界最轻的腕表。双指针以及CK的LOGO装饰表盘。防刮擦矿物水晶表镜，而且这款和银色款不同，内置的是瑞士石英机芯；表径37mm，厚7mm，防水30m。</p>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein</p>
      <p>模特同款，表盘嵌9颗白钻，通体镀玫瑰金，用码后新 低价，新春要让自己霸气一点。绑带设计通常能突出女性纤细的肢体，这款Calvin Klein</p>
    </section>
    <a href="#" class="buy_link">去亚马逊</a>
  </section>
</article>
<script type="text/javascript" src="js/zepto.min.js"></script>
<script type="text/javascript" src="js/iscroll.js"></script>
<script type="text/javascript" src="js/fastclick.js"></script>
<script>
  FastClick.attach(document.body);
  $(".header").on("touchmove", function(){
	  event.preventDefault();
  })
  //页面滚动
  var myScroll;
  function loaded() {
      myScroll = new IScroll(".act_wrapper", {scrollY:true});
  }
  //点击弹出图片
  $(".act_top").click(function(){
	  view_pics();
  })	
  
  //左右翻页活动详情
  var startX = 0, endX = 0, startY = 0, endY = 0;
  var movePrevent = false;
  var $act = $(".act_wrapper");
  
  $act.on("touchstart", function(e){
	  e = e.changedTouches[0];
	  onStart(e);
  });
  $act.on("touchmove", function(e){
	  onMove(e.changedTouches[0]);
  });
  $act.on("touchend", function(e){
	  onEnd(e.changedTouches[0]);
  });
  
  function onStart (e) {
	if(movePrevent == true){
		event.preventDefault();
		return false;
	}
	startX = e.pageX;
	startY = e.pageY;
  }
  
  function onMove (e) {
	if(movePrevent == true){
		event.preventDefault();
		return false;
	}
	event.preventDefault();
  }
  
  function onEnd (e) {
	  if(movePrevent == true){
		  event.preventDefault();
		  return false;
	  }
	  // 抬起点，页面位置
	  endX = e.pageX;
	  endY = e.pageY;
	  movePrevent = true; //页面动画时阻止触发 
	  // swipe事件默认大于20px才会触发
	  if(Math.abs(endX-startX)<=20) {
		  movePrevent = false;
	  }else{
		  if(Math.abs(endY-startY)<=50){
			  if(endX>startX){
				  preAct();
			  }else{
				  nextAct();
			  }
		  }else{
			  movePrevent = false;
		  }
	  }
  }
  
  var contStr = "<header class='act_top'>"+
	  "<img src='images/media_pcs/banner01.jpg'>"+            //显示图片
	  "<div class='act_info'>"+
	  "<span class='pic_name'>亚马逊</span>"+                  //商家
	  "<span class='pic_amount'>15张</span>"+                 //图片数量
	  "<span class='act_date'>发布日期：2015/01/12</span>"+     //日期
	  "</div></header>"+
	  "<section class='act_bottom'>"+
	  "<div class='act_tit'>Calvin Klein Agile K2Z2S61W 镶钻 女款时装腕表</div>"+  //活动商品名称
	  "<div class='act_price'>$128（需用码，约￥860）</div>"+                      //价格
	  "<div class='collect_share'>"+
	  "<a class='fr'><span class='collect_icon'></span>收藏(1)</a>"+       //收藏
	  "<a class='fr'><span class='share'></span>分享</a></div>"+            //分享
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	  
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	 
	  "<p>模特同款，表盘嵌9颗白钻，通体镀cdscdvcdsfvfdvfvdgbgfbghnghjnhghmhxzzzzzzzzzzzzzzzzzzzzmjkm,jk玫瑰金，用码后新低价，新春要让</p>"+	        //活动内容
	  "</section>";
  //后面追加
  function nextAct() {
	  $act.addClass("tran_effect");
	  $act.append("<section class='content' style='left:100%;'>"+contStr+"</section>"); 
	  $act.css("left","-100%");
	  moving();	 
  } 
  //前面追加
  function preAct() {
	  $act.addClass("tran_effect");
	  $("<section class='content' style='left:-100%;'>"+contStr+"</section>").appendTo($act);	
	  $act.css("left","100%");
	  moving();
  }
  function moving() {
	  movePrevent = true;
	  setTimeout(function() {
		  $act.removeClass("tran_effect").css("left","0");
		  $(".content:first-child", $act).remove();
		  $(".content:first-child", $act).css("left", "0");
		  movePrevent = false; 
		  loaded();
	  },800);
	  
	  //点击弹出图片
	  $(".act_top").click(function(){
	    view_pics();
      })		
  }
  
  //点击弹出图片
  var w = $(window).width(), pic_no = $("<div class='pic_no'></div>");  
  function view_pics() {
      var pic_bg = $("<div class='picFocus_bg'></div>");
	  $("body").append(pic_bg);
	  $(pic_bg).append(pic_no);
	  var ul = $("<div class='pic_focus_wrapper'><ul class='tran_effect'>" +
				 "<li id='img01'><div><img src='images/media_pcs/1.jpg'/><div></li>" +
				 "<li id='img02'><div><img src='images/media_pcs/1.jpg'/></div></li>" +
				 "<li id='img03'><div><img src='images/media_pcs/1.jpg'/></div></li>" +
				 "<li id='img04'><div><img src='images/media_pcs/1.jpg'/></div></li>" +
				 "<li id='img05'><div><img src='images/media_pcs/1.jpg'/></div></li>" +
			   "</ul></div>");
	  $(pic_bg).append(ul);
	  
	  var $pic_box = $(".pic_focus_wrapper ul"), $pic_list = $(".pic_focus_wrapper ul li"), h = $(window).height();
	  $pic_list.css({"line-height":h +"px"});
	  var len = $pic_list.length, i = 0;
	  $(pic_no).text("1/"+len);
	  var width = w*len;
	  $(".pic_focus_wrapper").width(w);
	  $pic_box.width(width);
	  $pic_list.width(w);	
	  
	  var startX = 0, endX = 0, startY = 0, endY = 0,
		  scrollPrevent = false, zoomed = false, scale = 1, re = 1, tY = 1024;
	  var imgScroll = null;
	  
	  function scrollP(i) {
	    imgScroll = new IScroll("#img0"+(i+1),{ zoom: true, scrollX: true, scrollY: true, mouseWheel: true, wheelAction: 'zoom'});     
	  }  
	  scrollP(0);

	  $pic_list.on("touchstart", function(){
		  t = event;	
	      t.preventDefault();    
		  t = t.touches[0], startX = t.pageX, startY = t.pageY;
	  });
	  
	  $pic_list.on("touchmove", function(){
		  t = event;
		  t.preventDefault();
		  var p = t.touches.length;
		  //防止正在缩放的时候图片变换
		  if(p>1){
			  scrollPrevent = true;
			  zoomed = true;
		  }else if(zoomed){
			  setTimeout(function(){
				  scrollPrevent = false;
				  zoomed = false;
		      },200)
		  }
	  }); 	  
	  
	  $pic_list.on("touchend", function(){
		  t = event;
		  t.preventDefault();
		  endX = t.changedTouches[0].pageX;
          endY = t.changedTouches[0].pageY;

		  if($("img", this).height()>h&&scale==1){tY = 30;}else {tY = 1024;}
		  scale = imgScroll.scale;
		  //// swip事件默认大于10px才会触发
		  if(Math.abs(endX-startX)>=10 && Math.abs(endY-startY)<tY && scale==1 && !scrollPrevent){
        	  if(endX>startX){
        		  prePic();
        	  }else{
        	      nextPic();
        	  }
          }
	  });
	  function showPic(index) {
		  $pic_box.css({"left": (-w*index)+"px"});
		  setTimeout(function(){
			  imgScroll.destroy();
		      scrollP(index);
		  }, 300);
		  $(pic_no).text((index+1)+"/"+len);
	  }
	  function prePic() {
		  if(i==0) {
			  showPic(i);
              return;
		  }
		  i--;
		  showPic(i);
	  }
	  function nextPic() {
		  if(i==len-1) {
			  showPic(i);
              return; 
		  }
		  i++;
		  showPic(i); 
	  }
	  $(".picFocus_bg").click(function(){
		  imgScroll.destroy();
		  $(this).remove(); 
	   });
	  event.stopPropagation();
  }
</script>
</body>
</html>